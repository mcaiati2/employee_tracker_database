{"version":3,"file":"query.js","sourceRoot":"","sources":["../../src/lib/query.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,yBAAyB,CAAC;AAE7C,MAAM,CAAC,KAAK,UAAU,iBAAiB;IACnC,MAAM,GAAG,GAAG;;;;;;;;;;;;;;;;;;;;;;KAsBX,CAAC;IAEF,MAAM,EAAC,IAAI,EAAC,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAGvC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,eAAe;IACjC,MAAM,GAAG,GAAG;;;;;KAKX,CAAC;IAEF,MAAM,EAAC,IAAI,EAAC,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEvC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,gBAAgB,CAAC,OAAe,EAAE,IAAY,EAAE,OAAe;IACjF,MAAM,GAAG,GAAG;;KAEX,CAAC;IAEF,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,gBAAgB;AAEvE,CAAC","sourcesContent":["import client from '../config/connection.js';\n\nexport async function getAllDepartments() {\n    const sql = `\n        SELECT\n        shops.id AS shop_id,\n        name AS shop_name,\n        address AS shop_address,\n        users.id AS user_id,\n        CONCAT(users.first_name, ' ', users.last_name) AS user_name,\n        users.email AS user_email,\n        CONCAT(managers.first_name, ' ', managers.last_name) AS manager,\n        wines.id AS wine_id,\n        brand AS wine_name,\n        type AS wine_type,\n        region AS wine_region,\n        price AS wine_price\n\n    FROM shops\n    JOIN users\n        ON shops.user_id = users.id\n    LEFT JOIN wines\n        ON shops.id = wines.shop_id\n    LEFT JOIN users AS managers\n        ON users.manager_id = managers.id;\n    `;\n\n    const {rows} = await client.query(sql);\n\n\n    return rows;\n}\n\nexport async function getAllEmployees() {\n    const sql = `\n    SELECT \n        id, \n        CONCAT(first_name, ' ', last_name) AS user_name\n    FROM users\n    `;\n\n    const {rows} = await client.query(sql);\n\n    return rows;\n}\n\nexport async function createDepartment(user_id: number, name: string, address: string) {\n    const sql = `\n    INSERT INTO shops (name, address, user_id) VALUES ($1, $2, $3)\n    `;\n\n    await client.query(sql, [name, address, user_id]); //prepared state\n\n}"]}